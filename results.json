{"platform":{"name":"debian","release":"10.10"},"profiles":[{"name":"tests from httpd_2.4x_server.controls.V-92597.rb","sha256":"94d79336d10acbf24a997f2d9a104d58e424fda3245d3fab6d2244f5414d3767","title":"tests from httpd_2.4x_server/controls/V-92597.rb","supports":[],"attributes":[{"name":"config_path","options":{"value":"Input 'config_path' does not have a value. Skipping test."}}],"groups":[{"id":"V-92597.rb","controls":["V-92597"]}],"controls":[{"id":"V-92597","title":"The Apache web server must limit the number of allowed simultaneous\nsession requests.","desc":"Apache web server management includes the ability to control the\nnumber of users and user sessions that utilize an Apache web server. Limiting\nthe number of allowed users and sessions per user is helpful in limiting risks\nrelated to several types of denial-of-service (DOS) attacks.\n\n    Although there is some latitude concerning the settings, they should follow\nDoD-recommended values and be configurable to allow for future DoD direction.\nWhile the DoD will specify recommended values, the values can be adjusted to\naccommodate the operational requirements of a given system.","descriptions":[{"label":"default","data":"Apache web server management includes the ability to control the\nnumber of users and user sessions that utilize an Apache web server. Limiting\nthe number of allowed users and sessions per user is helpful in limiting risks\nrelated to several types of denial-of-service (DOS) attacks.\n\n    Although there is some latitude concerning the settings, they should follow\nDoD-recommended values and be configurable to allow for future DoD direction.\nWhile the DoD will specify recommended values, the values can be adjusted to\naccommodate the operational requirements of a given system."},{"label":"rationale","data":""},{"label":"check","data":"Determine the location of the \"HTTPD_ROOT\" directory and the\n\"httpd.conf\" file:\n\n    # httpd -V | egrep -i 'httpd_root|server_config_file'\n    -D HTTPD_ROOT=\"/etc/httpd\"\n    -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"\n\n    Search for the directives \"KeepAlive\" and \"MaxKeepAliveRequests\" in the\n\"httpd.conf\" file:\n\n    # cat /<path_to_file>/httpd.conf | grep -i \"keepalive\"\n\n    KeepAlive On\n    MaxKeepAliveRequests 100\n\n    If the value of \"KeepAlive\" is set to \"off\" or does not exist, this is\na finding.\n\n    If the value of \"MaxKeepAliveRequests\" is set to a value less than\n\"100\" or does not exist, this is a finding."},{"label":"fix","data":"Determine the location of the \"HTTPD_ROOT\" directory and the\n\"httpd.conf\" file:\n\n    # httpd -V | egrep -i 'httpd_root|server_config_file'\n    -D HTTPD_ROOT=\"/etc/httpd\"\n    -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"\n\n    Set the \"KeepAlive\" directive to a value of \"on\"; add the directive if\nit does not exist.\n\n    Set the \"MaxKeepAliveRequests\" directive to a value of \"100\" or\ngreater; add the directive if it does not exist.\n\n    Restart Apache: apachectl restart"}],"impact":0.5,"refs":[],"tags":{"severity":"medium","gtitle":"SRG-APP-000001-WSR-000001","gid":"V-92597","rid":"SV-102685r1_rule","stig_id":"AS24-U1-000010","fix_id":"F-98839r1_fix","cci":"[CCI-000054]","nist":"[AC-10]"},"code":"control 'V-92597' do\n  title \"The Apache web server must limit the number of allowed simultaneous\nsession requests.\"\n  desc  \"Apache web server management includes the ability to control the\nnumber of users and user sessions that utilize an Apache web server. Limiting\nthe number of allowed users and sessions per user is helpful in limiting risks\nrelated to several types of denial-of-service (DOS) attacks.\n\n    Although there is some latitude concerning the settings, they should follow\nDoD-recommended values and be configurable to allow for future DoD direction.\nWhile the DoD will specify recommended values, the values can be adjusted to\naccommodate the operational requirements of a given system.\n  \"\n  desc  'rationale', ''\n  desc  'check', \"\n    Determine the location of the \\\"HTTPD_ROOT\\\" directory and the\n\\\"httpd.conf\\\" file:\n\n    # httpd -V | egrep -i 'httpd_root|server_config_file'\n    -D HTTPD_ROOT=\\\"/etc/httpd\\\"\n    -D SERVER_CONFIG_FILE=\\\"conf/httpd.conf\\\"\n\n    Search for the directives \\\"KeepAlive\\\" and \\\"MaxKeepAliveRequests\\\" in the\n\\\"httpd.conf\\\" file:\n\n    # cat /<path_to_file>/httpd.conf | grep -i \\\"keepalive\\\"\n\n    KeepAlive On\n    MaxKeepAliveRequests 100\n\n    If the value of \\\"KeepAlive\\\" is set to \\\"off\\\" or does not exist, this is\na finding.\n\n    If the value of \\\"MaxKeepAliveRequests\\\" is set to a value less than\n\\\"100\\\" or does not exist, this is a finding.\n  \"\n  desc 'fix', \"\n    Determine the location of the \\\"HTTPD_ROOT\\\" directory and the\n\\\"httpd.conf\\\" file:\n\n    # httpd -V | egrep -i 'httpd_root|server_config_file'\n    -D HTTPD_ROOT=\\\"/etc/httpd\\\"\n    -D SERVER_CONFIG_FILE=\\\"conf/httpd.conf\\\"\n\n    Set the \\\"KeepAlive\\\" directive to a value of \\\"on\\\"; add the directive if\nit does not exist.\n\n    Set the \\\"MaxKeepAliveRequests\\\" directive to a value of \\\"100\\\" or\ngreater; add the directive if it does not exist.\n\n    Restart Apache: apachectl restart\n  \"\n  impact 0.5\n  tag severity: 'medium'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag gid: 'V-92597'\n  tag rid: 'SV-102685r1_rule'\n  tag stig_id: 'AS24-U1-000010'\n  tag fix_id: 'F-98839r1_fix'\n  tag cci: '[CCI-000054]'\n  tag nist: '[AC-10]'\n\n  config_path = input('config_path')\n\n  describe apache_conf(config_path) do\n    its('KeepAlive') { should_not be_nil }\n  end\n\n  unless apache_conf(config_path).KeepAlive.nil?\n    apache_conf(config_path).KeepAlive.each do |value|\n      describe 'KeepAlive value should be set to On' do\n        subject { value }\n        it { should cmp 'On' }\n      end\n    end\n  end\n\n  describe apache_conf(config_path) do\n    its('MaxKeepAliveRequests') { should_not be_nil }\n  end\n\n  unless apache_conf(config_path).MaxKeepAliveRequests.nil?\n    apache_conf(config_path).MaxKeepAliveRequests.each do |value|\n      describe 'If the value of \"MaxKeepAliveRequests\" is set to a value less than \"100\" or does not exist, this is a finding.' do\n        subject { value }\n        it { should cmp < '100' }\n      end\n    end\n  end\nend\n","source_location":{"line":1,"ref":"httpd_2.4x_server/controls/V-92597.rb"},"waiver_data":{},"results":[{"status":"skipped","code_desc":"Apache Config Input 'config_path' does not have a value. Skipping test.","run_time":1.5e-05,"start_time":"2021-08-27T09:30:52-04:00","resource":"Apache Config Input 'config_path' does not have a value. Skipping test.","skip_message":"Can't find file: Input 'config_path' does not have a value. Skipping test.","resource_class":"apache_conf","resource_params":"[#<Inspec::Input::NO_VALUE_SET:0x00007ff3e7cdfdd8 @name=\"config_path\">]"},{"status":"skipped","code_desc":"Apache Config Input 'config_path' does not have a value. Skipping test.","run_time":5.0e-06,"start_time":"2021-08-27T09:30:52-04:00","resource":"Apache Config Input 'config_path' does not have a value. Skipping test.","skip_message":"Can't find file: Input 'config_path' does not have a value. Skipping test.","resource_class":"apache_conf","resource_params":"[#<Inspec::Input::NO_VALUE_SET:0x00007ff3e7cdfdd8 @name=\"config_path\">]"}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.002077},"version":"4.41.2"}